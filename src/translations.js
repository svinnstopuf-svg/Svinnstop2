// Translations for different languages
export const translations = {
  en: {
    // App title and header
    appName: 'Svinnstop',
    appDescription: 'Track your purchased food, expiry dates, and see recipe ideas.',
    
    // Form labels
    addItem: 'Add item',
    name: 'Name',
    namePlaceholder: 'e.g. milk, bread, tomato',
    quantity: 'Quantity',
    purchaseDate: 'Purchase date',
    expiryDate: 'Expiry date',
    addButton: 'Add',
    
    // Items section
    items: 'Items',
    searchPlaceholder: 'Search items...',
    selectButton: 'â˜‘ï¸ Select',
    exitButton: 'âœ• Exit',
    exportCSV: 'ðŸ“Š Export CSV',
    
    // Filters
    all: 'All',
    expiring: 'Expiring â‰¤ 3 days',
    expired: 'Expired',
    
    // Bulk actions
    selectAll: 'Select All',
    deselectAll: 'Deselect All',
    deleteSelected: 'Delete Selected',
    bulkDeleteConfirm: 'Delete {count} selected item{plural}?',
    selectedCount: '{selected} of {total} items selected',
    
    // Item status
    expired: 'Expired',
    expiresToday: 'Expires today',
    daysLeft: '{days} day{plural} left',
    expiry: 'Expiry',
    
    // Messages
    noItems: 'No items yet. Add your first item above.',
    noSearchResults: 'No items found matching "{query}"',
    noFilterResults: 'No items match the selected filter.',
    noItemsToExport: 'No items to export!',
    
    // Recipes
    recipeSuggestions: 'Recipe suggestions',
    noRecipesEmpty: 'Add items to see suggested recipes.',
    noRecipesFound: 'No recipes found with your current ingredients. Try adding more items!',
    ingredientsNeeded: 'Ingredients needed:',
    instructions: 'Instructions:',
    servings: 'serving{plural}',
    
    // Units
    units: {
      liters: 'liters',
      loaves: 'loaves',
      kg: 'kg',
      grams: 'grams',
      pieces: 'pieces',
      cans: 'cans',
      quantity: 'quantity'
    },
    
    // Footer
    dataStorage: 'Data is saved in your browser (localStorage).',
    
    // Undo
    undoButton: 'â†¶ï¸ Undo',
    undoTitle: 'Undo last deletion'
  },
  
  sv: {
    // App title and header
    appName: 'Svinnstop',
    appDescription: 'SpÃ¥ra din inkÃ¶pta mat, utgÃ¥ngsdatum och se receptidÃ©er.',
    
    // Form labels
    addItem: 'LÃ¤gg till vara',
    name: 'Namn',
    namePlaceholder: 't.ex. mjÃ¶lk, brÃ¶d, tomat',
    quantity: 'Antal',
    purchaseDate: 'InkÃ¶psdatum',
    expiryDate: 'UtgÃ¥ngsdatum',
    addButton: 'LÃ¤gg till',
    
    // Items section
    items: 'Varor',
    searchPlaceholder: 'SÃ¶k varor...',
    selectButton: 'â˜‘ï¸ VÃ¤lj',
    exitButton: 'âœ• Avsluta',
    exportCSV: 'ðŸ“Š Exportera CSV',
    
    // Filters
    all: 'Alla',
    expiring: 'GÃ¥r ut â‰¤ 3 dagar',
    expired: 'UtgÃ¥ngna',
    
    // Bulk actions
    selectAll: 'VÃ¤lj alla',
    deselectAll: 'Avmarkera alla',
    deleteSelected: 'Ta bort valda',
    bulkDeleteConfirm: 'Ta bort {count} valda vara{plural}?',
    selectedCount: '{selected} av {total} varor valda',
    
    // Item status
    expired: 'UtgÃ¥ngen',
    expiresToday: 'GÃ¥r ut idag',
    daysLeft: '{days} dag{plural} kvar',
    expiry: 'UtgÃ¥ng',
    
    // Messages
    noItems: 'Inga varor Ã¤nnu. LÃ¤gg till din fÃ¶rsta vara ovan.',
    noSearchResults: 'Inga varor hittades som matchar "{query}"',
    noFilterResults: 'Inga varor matchar det valda filtret.',
    noItemsToExport: 'Inga varor att exportera!',
    
    // Recipes
    recipeSuggestions: 'ReceptfÃ¶rslag',
    noRecipesEmpty: 'LÃ¤gg till varor fÃ¶r att se receptfÃ¶rslag.',
    noRecipesFound: 'Inga recept hittades med dina nuvarande ingredienser. FÃ¶rsÃ¶k lÃ¤gga till fler varor!',
    ingredientsNeeded: 'Ingredienser som behÃ¶vs:',
    instructions: 'Instruktioner:',
    servings: 'portion{plural}',
    
    // Units
    units: {
      liters: 'liter',
      loaves: 'limpor',
      kg: 'kg',
      grams: 'gram',
      pieces: 'stycken',
      cans: 'burkar',
      quantity: 'antal'
    },
    
    // Footer
    dataStorage: 'Data sparas i din webblÃ¤sare (localStorage).',
    
    // Undo
    undoButton: 'â†¶ï¸ Ã…ngra',
    undoTitle: 'Ã…ngra senaste borttagning'
  },
  
  de: {
    // App title and header
    appName: 'Svinnstop',
    appDescription: 'Verfolge deine gekauften Lebensmittel, Ablaufdaten und erhalte Rezeptideen.',
    
    // Form labels
    addItem: 'Artikel hinzufÃ¼gen',
    name: 'Name',
    namePlaceholder: 'z.B. Milch, Brot, Tomate',
    quantity: 'Menge',
    purchaseDate: 'Kaufdatum',
    expiryDate: 'Ablaufdatum',
    addButton: 'HinzufÃ¼gen',
    
    // Items section
    items: 'Artikel',
    searchPlaceholder: 'Artikel suchen...',
    selectButton: 'â˜‘ï¸ AuswÃ¤hlen',
    exitButton: 'âœ• Beenden',
    exportCSV: 'ðŸ“Š CSV exportieren',
    
    // Filters
    all: 'Alle',
    expiring: 'LÃ¤uft ab â‰¤ 3 Tage',
    expired: 'Abgelaufen',
    
    // Bulk actions
    selectAll: 'Alle auswÃ¤hlen',
    deselectAll: 'Alle abwÃ¤hlen',
    deleteSelected: 'AusgewÃ¤hlte lÃ¶schen',
    bulkDeleteConfirm: '{count} ausgewÃ¤hlte Artikel lÃ¶schen?',
    selectedCount: '{selected} von {total} Artikel ausgewÃ¤hlt',
    
    // Item status
    expired: 'Abgelaufen',
    expiresToday: 'LÃ¤uft heute ab',
    daysLeft: '{days} Tag{plural} Ã¼brig',
    expiry: 'Ablauf',
    
    // Messages
    noItems: 'Noch keine Artikel. FÃ¼ge deinen ersten Artikel oben hinzu.',
    noSearchResults: 'Keine Artikel gefunden, die "{query}" entsprechen',
    noFilterResults: 'Keine Artikel entsprechen dem gewÃ¤hlten Filter.',
    noItemsToExport: 'Keine Artikel zum Exportieren!',
    
    // Recipes
    recipeSuggestions: 'RezeptvorschlÃ¤ge',
    noRecipesEmpty: 'FÃ¼ge Artikel hinzu, um RezeptvorschlÃ¤ge zu sehen.',
    noRecipesFound: 'Keine Rezepte mit deinen aktuellen Zutaten gefunden. Versuche mehr Artikel hinzuzufÃ¼gen!',
    ingredientsNeeded: 'BenÃ¶tigte Zutaten:',
    instructions: 'Anweisungen:',
    servings: 'Portion{plural}',
    
    // Units
    units: {
      liters: 'Liter',
      loaves: 'Laibe',
      kg: 'kg',
      grams: 'Gramm',
      pieces: 'StÃ¼ck',
      cans: 'Dosen',
      quantity: 'Menge'
    },
    
    // Footer
    dataStorage: 'Daten werden in deinem Browser gespeichert (localStorage).',
    
    // Undo
    undoButton: 'â†¶ï¸ RÃ¼ckgÃ¤ngig',
    undoTitle: 'Letzte LÃ¶schung rÃ¼ckgÃ¤ngig machen'
  }
}

// Get browser language and fall back to English
export function getLanguage() {
  const browserLang = navigator.language || navigator.languages[0]
  const langCode = browserLang.split('-')[0].toLowerCase()
  
  // Check if we have translations for this language
  if (translations[langCode]) {
    return langCode
  }
  
  // Default to English
  return 'en'
}

// Translation function with placeholder support
export function t(key, language, replacements = {}) {
  const keys = key.split('.')
  let translation = translations[language]
  
  // Navigate through nested keys
  for (const k of keys) {
    if (translation && translation[k]) {
      translation = translation[k]
    } else {
      // Fallback to English if key not found
      translation = translations.en
      for (const k of keys) {
        if (translation && translation[k]) {
          translation = translation[k]
        } else {
          return key // Return key if not found in English either
        }
      }
      break
    }
  }
  
  if (typeof translation !== 'string') {
    return key
  }
  
  // Replace placeholders
  let result = translation
  Object.keys(replacements).forEach(placeholder => {
    const value = replacements[placeholder]
    result = result.replace(new RegExp(`{${placeholder}}`, 'g'), value)
  })
  
  return result
}

// Helper for pluralization
export function plural(count) {
  return count === 1 ? '' : 's'
}